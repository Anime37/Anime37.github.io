<!DOCTYPE html>
<html>

<head>
    <title>Twitch Clip Player</title>
    <style>
        #clip_container {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }
    </style>
</head>

<body>
    <div id="clip_container">
        <!-- Create an empty iframe with an ID -->
        <iframe id="clip_frame" style="width: 800px; height: 400px;"></iframe>

        <!-- Add an input field and a button for the user to input a new clip slug -->
        <input type="text" id="newClipSlug" placeholder="Enter a new Clip Slug">
        <button onclick="updateClipSlug()">Update Clip</button>

        <!-- Add an input field and a button for the user to configure the reload time -->
        <input type="number" id="reloadTime" placeholder="Reload Time (in milliseconds)">
        <button onclick="updateReloadTime()">Apply Reload Time</button>
    </div>

    <script type="text/javascript">
        // Define your parent domains
        var parentDomains = ['anime37.github.io'];

        // Function to set the clip slug in local storage
        function setClipSlug(slug) {
            localStorage.setItem('clipSlug', slug);
        }

        // Function to get the clip slug from local storage
        function getClipSlug() {
            return localStorage.getItem('clipSlug');
        }

        // Function to update the clipSlug and load the iframe
        function updateClipSlug() {
            var newClipSlug = document.getElementById('newClipSlug').value;
            if (newClipSlug) { // Check if a new slug has been entered
                setClipSlug(newClipSlug);

                // Build the src URL for the iframe with autoplay=true
                var srcUrl = "https://clips.twitch.tv/embed?clip=" + newClipSlug + "&autoplay=true&parent=" + parentDomains.join('&parent=');

                // Set the iframe's src attribute with the updated URL
                document.getElementById('clip_frame').setAttribute('src', srcUrl);
            }
        }

        // Function to set the reload time in local storage
        function setReloadTime(reloadTime) {
            localStorage.setItem('reloadTime', reloadTime);
        }

        // Function to get the reload time from local storage
        function getReloadTime() {
            return localStorage.getItem('reloadTime');
        }

        // Function to update the reload time
        function updateReloadTime() {
            var newReloadTime = document.getElementById('reloadTime').value;
            if (newReloadTime) { // Check if a new reload time has been entered
                setReloadTime(newReloadTime);

                clearInterval(reloadInterval); // Clear the previous interval
                reloadInterval = setInterval(function () {
                    location.reload();
                }, newReloadTime);
            }
        }

        // Get the clip slug from local storage
        var clipSlug = getClipSlug();

        // If a slug is saved in local storage, load the clip
        if (clipSlug) {
            var srcUrl = "https://clips.twitch.tv/embed?clip=" + clipSlug + "&autoplay=true&parent=" + parentDomains.join('&parent=');
            document.getElementById('clip_frame').setAttribute('src', srcUrl);
        }

        // Initialize the reload time and set the initial reload interval
        var initialReloadTime = getReloadTime() || 30000; // Default reload time: 30 seconds
        var reloadInterval = setInterval(function () {
            location.reload();
        }, initialReloadTime);
    </script>
</body>

</html>